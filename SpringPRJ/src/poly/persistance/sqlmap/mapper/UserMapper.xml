<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- JAVA와 연결할 Mapper 파일 설정 -->
<mapper namespace="poly.persistance.mapper.IUserMapper">
	
	<!-- USER 등록 -->
	<insert id="insertUserInfo" parameterType="UserDTO" >
		INSERT INTO USER_INFO
			(
				USER_SEQ,
				USER_ID,
				USER_EMAIL,
				USER_PWD,
				USER_AGE,
				USER_DEPT,
				USER_MBTI,
				USER_STUDY,
				JOIN_DT
			)
		VALUES(	
				(SELECT IFNULL(MAX(USER_SEQ), 0)+1 FROM USER_INFO A),
				#{user_id},
				#{user_email},
				#{user_pwd},
				#{user_age},
				#{user_dept},
				#{user_mbti},
				#{user_study},
				SYSDATE()
				
			)
				
	
	</insert>
	
	<!-- EMAIL로 회원가입 중복 방지 -->
	<select id="getUserExists" parameterType="UserDTO" resultType="UserDTO">
		<!-- case 값  when 조건 then 결과값 end 별칭 -->
		<!-- select decode(count(*),1,'true','false') as result from test where id = 'test' pw='123'; -->
		SELECT CASE WHEN COUNT(*)=0 THEN 'N' ELSE 'Y' END EXISTS_YN
		FROM USER_INFO
		WHERE USER_EMAIL = #{user_email}
	
	</select>
	
	<!-- USER 조회 -->
	<select id="getUserInfo" resultType="UserDTO">
	SELECT * 
	FROM USER_INFO
	WHERE 
		USER_ID = #{user_id} AND USER_PWD = #{user_pwd}
	</select>
	
	<!-- ID 조회 -->
	<select id="idCheck" resultType="UserDTO">
	SELECT USER_ID
	FROM USER_INFO
	WHERE
		USER_ID = #{user_id}
	</select>
</mapper>