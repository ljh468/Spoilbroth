<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- JAVA와 연결할 Mapper 파일 설정 -->
<mapper namespace="poly.persistance.mapper.IStudyMapper">

	<!-- 모든 스터디 리스트 조회 쿼리 -->
	<select id="getAllStudyList" resultType="StudyListDTO">
		SELECT *
		FROM STUDY_INFO
	</select>
	
	<!-- 스터디그룹 등록 -->
	<insert id="insertStudyInfo" parameterType="StudyListDTO" >
		INSERT INTO STUDY_INFO
			(
				STUDY_SEQ,
				STUDY_DT,
				STUDY_FIELD,
				STUDY_NAME,
				STUDY_MEMBER,
				STUDY_TITLE,
				STUDY_CONTENTS
			)
		VALUES(	
				(SELECT IFNULL(MAX(STUDY_SEQ), 0)+1 FROM STUDY_INFO S),
				#{study_dt},
				#{study_field},
				#{study_name},
				#{study_member},
				#{study_title},
				#{study_contents}
			)
				
	
	</insert>
	
	<!-- 스터디 이름으로 개설 중복 방지 -->
	<select id="getStudyExists" parameterType="StudyListDTO" resultType="StudyListDTO">
		<!-- case 값  when 조건 then 결과값 end 별칭 -->
		<!-- select decode(count(*),1,'true','false') as result from test where id = 'test' pw='123'; -->
		SELECT CASE WHEN COUNT(*)=0 THEN 'N' ELSE 'Y' END EXISTS_YN
		FROM STUDY_INFO
		WHERE STUDY_NAME = #{study_name}
	</select>
	
	<!-- 특정 스터디정보 가져오기 -->
	<select id="getStudyInfo" parameterType="String" resultType="StudyListDTO">
	SELECT *
	FROM STUDY_INFO
	WHERE STUDY_NAME = #{study_name}
	</select>
	
	
</mapper>